var JsonApiStore=function(t){"use strict";var i=function(){function t(t,i){this.store=i,this.attributes={},this.relationships={},this.meta={},this.links={},this.merge(t)}return t.prototype.identifier=function(){return{id:this.id,type:this.type}},t.prototype.merge=function(t){var i=this;if("type"in t&&(this.type=t.type),"id"in t&&(this.id=t.id),"attributes"in t&&(Object.assign(this.attributes,t.attributes),Object.keys(t.attributes).forEach((function(t){Object.defineProperty(i,t,{configurable:!0,get:function(){return i.attributes[t]},set:function(e){return i.attributes[t]=e}})}))),"relationships"in t)for(var e=function(t,e){r.relationships[t]=r.relationships[t]||{},Object.assign(r.relationships[t],e),Object.defineProperty(r,t,{configurable:!0,get:function(){return i.store.find(i.relationships[t].data)},set:function(e){return i.relationships[t].data=Array.isArray(e)?e.map((function(t){return t.identifier()})):e.identifier()}})},r=this,n=0,s=Object.entries(t.relationships);n<s.length;n++){var o=s[n];e(o[0],o[1])}"links"in t&&(this.links=t.links),"meta"in t&&(this.meta=t.meta)},t}(),e=function(){function t(t){void 0===t&&(t={}),this.models=t,this.graph={}}return t.prototype.model=function(t,i){this.models[t]=i},t.prototype.find=function(t,i){var e=this;return null===t?null:Array.isArray(t)?t.map((function(t){return e.find(t)})):"object"==typeof t?this.find(t.type,t.id):this.graph[t]&&this.graph[t][i]||null},t.prototype.findAll=function(t){var i=this;return this.graph[t]?Object.keys(this.graph[t]).map((function(e){return i.graph[t][e]})):[]},t.prototype.sync=function(t){var i=this.syncResource.bind(this);return"included"in t&&t.included.map(i),{data:Array.isArray(t.data)?t.data.map(i):i(t.data),meta:t.meta,links:t.links}},t.prototype.syncResource=function(t){var i=t.type,e=t.id;return this.graph[i]=this.graph[i]||{},this.graph[i][e]?this.graph[i][e].merge(t):this.graph[i][e]=this.createModel(t),this.graph[i][e]},t.prototype.createModel=function(t){return new(this.models[t.type]||i)(t,this)},t.prototype.forget=function(t){delete this.graph[t.type][t.id]},t.prototype.reset=function(){this.graph={}},t}();return t.Model=i,t.Store=e,t}({});
